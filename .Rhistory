local({pkg <- select.list(sort(.packages(all.available = TRUE)),graphics=TRUE)
if(nchar(pkg)) library(pkg, character.only=TRUE)})
rm(list=ls())
library(FactoMineR)
base<-read.csv2("basechoco.csv",row.names=1,header=TRUE,dec=",")
dim(base)
colnames(base)
summary(base)
View(base)
?PCA
res.pca<-PCA(base [,c(1,3:12,14)])
names(res.pca)
summary(res.pca)
round(res.pca$eig,3)
barplot(res.pca$eig[,1],main="valores propios",names.arg=paste("dim",1:nrow(res.pca$eig)))
summary(res.pca)
sum(res.pca$eig[,1])
load("F:/ADEI/ADEI-CaseStudy/workspace.RData")
library("FactoMineR", lib.loc="\\\\pax/perfils/gorka.pinol.CR/Documents/R/win-library/3.4")
sel
sel <- is.na(df$Total_amount)
sel
df2 <- df[-which(sel),]
colnames([,4:23])
colnames(df[,4:23])
condes(dfbis[,4:23],num.var=15)
condes(df2[,4:23],num.var=15)
condes(df2,num.var=15)
colnames(df2)
condes(df2,num.var=19)
View(df2)
View(df2)
View(df2)
View(df2)
df3 <- df
df3$lpep_pickup_datetime <- NULL
df3$Lpep_dropoff_datetime <- NULL
View(df3)
sel <- is.na(df3$Total_amount)
df4 <- df3[-which(sel),]
colnames(df3[,4:23])
colnames(df3[,4:21])
condes(df4,num.var=14)
df3$Ehail_fee <-NULL
sel <- is.na(df3$Total_amount)
df4 <- df3[-which(sel),]
colnames(df3[,4:21])
condes(df4,num.var=13)
colnames(df4[,4:21])
dfNoRate <- df4
View(dfNoRate)
sel<-rownames(dfNoRate[which(df[,"RateCodeID"]==0),])
sel<-rownames(dfNoRate[which(df[,"RateCodeID"]=="JFK"),])
dfNoRate[sel, "RateCodeID"]<- NA
sel<-rownames(dfNoRate[which(df[,"RateCodeID"]=="Newark"),])
dfNoRate[sel, "RateCodeID"]<- NA
colnames(dfNoRate[,4:21])
condes(dfNoRate,num.var=17)
colnames(df4[,4:23])
colnames(df4)
condes(df4,num.var=16)
colnames(dfNoRate)
condes(dfNoRate,num.var=16)
View(dfNoRate)
condes(dfNoRate,num.var=16)
save.image("F:/ADEI/ADEI-CaseStudy/workspace.RData")
decoupe<-quantile (df4$Total_amount,na.rm=TRUE)
decoupe[1]<-decoupe[1]-1e-10
df4$Tamount_inclass<-cut(df4$Total_amount,breaks=decoupe)
View(df4)
summary(df4$Tamount_inclass)
df4[is.na(df4$Total_amount),]
levels(df4$Tamount_inclass)<-c("Very_small_amount","small_amount","Moderate_amount","High_amount")
View(df4)
colnames(df4)
catdes(df4,num.var=16)
catdes(df4,num.var=22)
save.image("F:/ADEI/ADEI-CaseStudy/workspace.RData")
load("F:/ADEI/ADEI-CaseStudy/workspace.RData")
View(df4)
load("F:/ADEI/ADEI-CaseStudy/workspace.RData")
df4$Tip<-"TIP_NO"
df4$Tip[df4$Tip_amount>0]<-"TIP_YES"
df4$Tip<-as.factor(df4$Tip)
summary(dfbis$Tip)
summary(df4$Tip)
colnames(df4)
catdes(df4,num.var=23)
library("FactoMineR", lib.loc="\\\\pax/perfils/gorka.pinol.CR/Documents/R/win-library/3.4")
catdes(df4,num.var=23)
catdes(df4,num.var=23)
save.image("F:/ADEI/ADEI-CaseStudy/workspace.RData")
load("F:/ADEI/ADEI-CaseStudy/workspace.RData")
library("FactoMineR", lib.loc="\\\\pax/perfils/gorka.pinol.CR/Documents/R/win-library/3.4")
res.hcpc<-HCPC(res.pca,order=TRUE)
res.hcpc<-HCPC(res.pca,order=TRUE, nb.clust = -1)
res.hcpc$desc.axes
res.hcpc$desc.var
res.hcpc$desc.var
res.hcpc$desc.ind
names(res.pca$ind)
round(cbind(res.pca$ind$coord[,1:3],res.pca$ind$cos2[,1:3],res.pca$ind$contrib[,1:3]),2)
round(cbind(res.pca$var$coord[,1:3],res.pca$var$cos2[,1:3],res.pca$var$contrib[,1:3]),2)
round(cbind(res.pca$var$cos2[,1:4],res.pca$var$contrib[,1:4]),2)
dimdesc(res.pca)
summary(res.hcpc$data.clust$clust)
names(res.hcpc$desc.var)
res.hcpc$desc.var$test.chi2
res.hcpc$desc.var$category
res.hcpc$desc.var$quanti.var
res.hcpc$desc.var$quanti
names(res.hcpc$desc.ind)
res.hcpc$desc.ind$para
res.hcpc$desc.ind$dist
summary(res.hcpc$data.clust$clust)
### desc.var ###
### A. The description of the clusters by the variables ###
names(res.hcpc$desc.var)
### desc.var$test.chi2 ###
### A.1. The categorical variables which characterizes the clusters ###
res.hcpc$desc.var$test.chi2
### desc.var$category ###
### A.2. The description of each cluster by the categories ##
res.hcpc$desc.var$category
### desc.var$quanti.var ###
### A.3. The quantitative variables which characterizes the clusters ###
res.hcpc$desc.var$quanti.var
### desc.var$quanti ###
### A.4. The description of each cluster by the quantitative variables ###
res.hcpc$desc.var$quanti
### desc.axes ###
### B. The description of the clusters by the axes ###
names(res.hcpc$desc.axes)
res.hcpc$desc.axes$quanti.var
res.hcpc$desc.axes$quanti
### desc.ind ###
### C. The description of the clusters by the individuals ###
names(res.hcpc$desc.ind)
res.hcpc$desc.ind$para
res.hcpc$desc.ind$dist
# Examinar los valores de los individuos que caracterizan a las clases
View(df4)
save.image("F:/ADEI/ADEI-CaseStudy/workspace.RData")
load("//pax/perfils/gorka.pinol.CR/Desktop/Anscombe73raw.RData")
View(anscombe)
load("//pax/perfils/gorka.pinol.CR/Desktop/Anscombe73raw.RData")
plot(XA, YA, main="Joc de dades A", pch=19)
attach(anscombe) # MAI FER SERVIR EN EXÀMENS NI SITUACIONS DELICADES!!!!
XA
plot(XA, YA, main="Joc de dades A", pch=19)
ma <- lm(YA~XA, data=anscombe) # Per defecte asumeix que és una constant
summary(ma)
setwd("F:/ADEI/ADEI-CaseStudy")
load("F:/ADEI/ADEI-CaseStudy/.RData")
names(dfD4)
summary(dfD4$pickup)
vars_con<-names(dfD4)[c(6:16,18,19)];vars_con
vars_cexp<-vars_con[c(1:12)];vars_cexp
round(cor(dfD4[,c("Total_amount",vars_cexp)]),dig=2)
?cor
round(cor(dfD4[,c("Total_amount",vars_cexp)],use="pairwise.complete.obs"),dig=2)
m20<-lm(Total_amount~.,data=dfD4[,vars_con])
summary(m20)
vif(m20)
# Load Required Packages: to be increased over the course
requiredPackages <- c("effects","FactoMineR","car", "factoextra","RColorBrewer","ggplot2")
missingPackages <- requiredPackages[!(requiredPackages %in% installed.packages()[,"Package"])]
if(length(missingPackages)) install.packages(missingPackages)
lapply(requiredPackages, require, character.only = TRUE)
vif(m20)
m21<-step(m20,k=log(nrow(dfD4)))  # BIC
