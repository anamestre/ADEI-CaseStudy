summary(df$Pickup_longitude)
load("C:/Users/Gorka/Desktop/Uni/ADEI/ADEI-CaseStudy/workspace.RData")
boxplot(df$Pickup_latitude)
df2$Pickup_latitude <- as.numeric(df$Pickup_latitude)
df2$Pickup_longitude <- as.numeric(df$Pickup_longitude)
df2$Dropoff_latitude <- as.numeric(df$Dropoff_latitude)
df2$Dropoff_longitude <- as.numeric(df$Dropoff_longitude)
boxplot(df$Pickup_latitude)
boxplot(df$Pickup_longitude)
boxplot(df$Dropoff_latitude)
boxplot(df$Dropoff_longitude)
boxplot(df$Trip_distance)
boxplot(df$Fare_amount)
boxplot(df$Extra)
boxplot(df$MTA_tax)
boxplot(df$Tip_amount)
boxplot(df$Tolls_amount)
boxplot(df$improvement_surcharge)
boxplot(df$Total_amount)
boxplot(df$Passenger_count)
hist(df$Pickup_latitude, main = NULL, xlab = NULL, ylab = NULL)
?boxplot
summary(df$Pickup_latitude)
df2$Pickup_latitude <- as.numeric(df$Pickup_latitude)
summary(df$Pickup_latitude)
df$Pickup_latitude <- as.numeric(df$Pickup_latitude)
df$Pickup_longitude <- as.numeric(df$Pickup_longitude)
df$Dropoff_latitude <- as.numeric(df$Dropoff_latitude)
df$Dropoff_longitude <- as.numeric(df$Dropoff_longitude)
boxplot(df$Trip_distance)
boxplot(df$Fare_amount)
boxplot(df$Extra)
boxplot(df$MTA_tax)
boxplot(df$Tip_amount)
hist(df$Tolls_amount, main = NULL, xlab = NULL, ylab = NULL)
hist(df$improvement_surcharge, main = NULL, xlab = NULL, ylab = NULL)
hist(df$Total_amount, breaks = 40, main = NULL, xlab = NULL, ylab = NULL)
hist(df$Passenger_count, main = NULL, xlab = NULL, ylab = NULL)
df$Pickup_latitude <- as.numeric(df$Pickup_latitude)
df$Pickup_longitude <- as.numeric(df$Pickup_longitude)
df$Dropoff_latitude <- as.numeric(df$Dropoff_latitude)
df$Dropoff_longitude <- as.numeric(df$Dropoff_longitude)
df$Trip_distance <- as.numeric(df$Trip_distance)
df$Fare_amount <- as.numeric(df$Fare_amount)
df$Extra <- as.numeric(df$Extra)
df$MTA_tax <- as.numeric(df$MTA_tax)
df$improvement_surcharge <- as.numeric(df$improvement_surcharge)
df$Total_amount <- as.numeric(df$Total_amount)
df$Passenger_count <- as.numeric(df$Passenger_count)
boxplot(df$Pickup_latitude)
boxplot(df$Pickup_longitude)
boxplot(df$Pickup_latitude)
boxplot(df$Pickup_longitude)
boxplot(df$Dropoff_latitude)
boxplot(df$Dropoff_longitude)
boxplot(df$Trip_distance)
boxplot(df$Fare_amount)
boxplot(df$Extra)
boxplot(df$Extra)
boxplot(df$MTA_tax)
boxplot(df$Tip_amount)
boxplot(df$improvement_surcharge)
boxplot(df$Total_amount)
boxplot(df$Passenger_count)
hist(df$Pickup_latitude, main = NULL, xlab = NULL, ylab = NULL)
hist(df$Pickup_longitude, main = NULL, xlab = NULL, ylab = NULL)
boxplot(df$Dropoff_latitude)
hist(df$Dropoff_latitude, main = NULL, xlab = NULL, ylab = NULL)
hist(df$Dropoff_longitude, main = NULL, xlab = NULL, ylab = NULL)
hist(df$Trip_distance, main = NULL, xlab = NULL, ylab = NULL)
hist(df$Fare_amount, main = NULL, xlab = NULL, ylab = NULL)
hist(df$Extra, main = NULL, xlab = NULL, ylab = NULL)
hist(df$MTA_tax, main = NULL, xlab = NULL, ylab = NULL)
hist(df$Tip_amount, main = NULL, xlab = NULL, ylab = NULL)
hist(df$Tolls_amount, main = NULL, xlab = NULL, ylab = NULL)
hist(df$improvement_surcharge, main = NULL, xlab = NULL, ylab = NULL)
hist(df$Total_amount, breaks = 40, main = NULL, xlab = NULL, ylab = NULL)
hist(df$Passenger_count, main = NULL, xlab = NULL, ylab = NULL)
save.image("C:/Users/Gorka/Desktop/Uni/ADEI/ADEI-CaseStudy/workspace.RData")
summary(df$MTA_tax)
boxplot(df$NAvalues)
hist(df$NAvalues, main = NULL, xlab = NULL, ylab = NULL)
summary(df$NAvalues)
?cov
load("C:/Users/Gorka/Desktop/Uni/ADEI/ADEI-CaseStudy/workspace.RData")
library(FactoMineR)
install.packages("FactoMineR")
library(FactoMineR)
?PCA
res.pca<-PCA(base,
quali.sup=c(1,2,16,17,18,19,20),quanti.sup= c(3:6,15,21,22))
res.pca<-PCA(,
quali.sup=c(1,2,16,17,18,19,20),quanti.sup= c(3:6,15,21,22))
res.pca<-PCA(df4,
quali.sup=c(1,2,16,17,18,19,20),quanti.sup= c(3:6,15,21,22))
rm(i)
rm(j)
rm(sel)
rm(vendorCounts)
rm(dropoffCounts)
rm(paytypeCounts)
rm(pickupCounts)
rm(ratecodeCounts)
rm(decoupe)
rm(storefwdCounts)
rm(triptypeCounts)
rm(dfNoRate)
dfNoQuantitatives <- df4
dfNoQuantitatives$RateCodeID <- NULL
dfNoQuantitatives$Tamount_inclass <- NULL
dfNoQuantitatives$Tip <- NULL
res.pca<-PCA(dfNoQuantitatives,
quali.sup=c(1,2,16,17,18,19,20),quanti.sup= c(3:6,15,21,22))
rm(dfNoQuantitatives)
colnames(df4)
colnames(df1)
colnames(df)
res.pca<-PCA(df4,
quali.sup=c(1,3,17,18,19,20,22,23),quanti.sup= c(4:8,10,13,14,16,))
colnames(df4)
res.pca<-PCA(df4,
quali.sup=c(1,3,17,18,19,20,22,23),quanti.sup= c(4:8,10,13,14,16))
res.pca<-PCA(df4, quali.sup=c(1,2,3,17,18,19,20,22,23),quanti.sup= c(4:8,10,13,14,16))
plot.PCA(res.pca,choix=c("var"),invisible=c("quanti.sup"))
plot.PCA(res.pca,choix=c("var"),invisible=c("var"))
plot.PCA(res.pca,choix=c("var"),invisible=c("quanti.sup"))
plot.PCA(res.pca,choix=c("ind"),invisible=c("ind"))
plot.PCA(res.pca,choix=c("var"),invisible=c("quanti.sup"))
plot.PCA(res.pca,choix=c("var"),invisible=c("var"))
plot.PCA(res.pca,choix=c("var"),invisible=c("quanti.sup"))
plot.PCA(res.pca,choix=c("ind"),invisible=c("ind"))
plot.PCA(res.pca,choix=c("var"),invisible=c("quanti.sup"))
plot.PCA(res.pca,choix=c("var"),invisible=c("var"))
plot.PCA(res.pca,choix=c("var"),invisible=c("quanti.sup"))
plot.PCA(res.pca)
res.pca<-PCA(df4, quali.sup=c(1,2,3,17,18,19,20,22,23),quanti.sup= c(4:8,10,13,14,16))
names(res.pca)
summary(res.pca)
round(res.pca$eig,3)
barplot(res.pca$eig[,1],main="valores propios",names.arg=paste("dim",1:nrow(res.pca$eig)))
summary(res.pca)
sum(res.pca$eig[,1])
plot.PCA(res.pca,choix=c("var"),invisible=c("quanti.sup"))
plot.PCA(res.pca,choix=c("var"),invisible=c("var"))
plot.PCA(res.pca,choix=c("var"),invisible=c("quanti.sup"))
plot.PCA(res.pca,choix=c("ind"),invisible=c("ind"))
?plot.PCA
plot.PCA(res.pca,choix=c("var"),invisible=c("quanti.sup"))
plot.PCA(res.pca,choix=c("var"),invisible=c("quanti.sup"))
plot.PCA(res.pca,choix=c("var"),invisible=c("var"))
res.pca<-PCA(df4, quali.sup=c(1,2,3,17,18,19,20,22,23),quanti.sup= c(4:8,10,13,14,16))
plot.PCA(res.pca,choix=c("var"),invisible=c("quanti.sup"))
summary(res.pca)
res.pca<-PCA(df4, quali.sup=c(1,2,3,17,18,19,20,22,23),quanti.sup= c(4:8,10,13,14,16))
colnames(df4)
df4$NAvalues <- NULL
res.pca<-PCA(df4, quali.sup=c(1,2,3,17,18,19,20,21,22),quanti.sup= c(4:8,10,13,14,16))
names(res.pca$ind)
round(cbind(res.pca$ind$coord[,1:3],res.pca$ind$cos2[,1:3],res.pca$ind$contrib[,1:3]),2)
res.pca$ind$coord
rango<-order(res.pca$ind$coord[,1])
length(rango)
row.names(base)[rango[4660:4669]]
row.names(df4)[rango[4660:4669]]
row.names(bdf4)[rango[1:10]]
row.names(df4)[rango[1:10]]
df4[which(row.names(df4)=="1329730"),1:22]
df4[which(row.names(df4)=="363607"),1:22]
round(cbind(res.pca$var$coord[,1:3],res.pca$var$cos2[,1:3],res.pca$var$contrib[,1:3]),2)
round(cbind(res.pca$var$cos2[,1:4],res.pca$var$contrib[,1:4]),2)
dimdesc(res.pca)
dimdesc(res.pca)
plot.PCA(res.pca,choix=c("ind"),cex=0.8)
plot.PCA(res.pca,choix=c("ind"),invisible=c("quali"),axes=c(3,4))
plot.PCA(res.pca,choix=c("var"),axes=c(3,4))
plot.PCA(res.pca,choix=c("ind"),cex=0.8)
plot.PCA(res.pca,choix=c("ind"),invisible=c("quali"),axes=c(3,4))
plot.PCA(res.pca,choix=c("var"),axes=c(3,4))
round(cbind(res.pca$var$coord[,1:3],res.pca$var$cos2[,1:3],res.pca$var$contrib[,1:3]),2)
round(cbind(res.pca$var$cos2[,1:4],res.pca$var$contrib[,1:4]),2)
res.pca <- PCA(base,quanti.sup=c(2,13,15,18),quali.sup=c(16,17,19),ncp=4)
res.pca<-PCA(df4, quali.sup=c(1,2,3,17,18,19,20,21,22, 23),quanti.sup= c(4:8,10,13,14,16), ncp=2, graph = FALSE)
library("FactoMineR", lib.loc="~/R/win-library/3.4")
res.pca<-PCA(df4, quali.sup=c(1,2,3,17,18,19,20,21,22, 23),quanti.sup= c(4:8,10,13,14,16), ncp=2, graph = FALSE)
res.pca<-PCA(df4, quali.sup=c(1,2,3,17,18,19,20,21,22, 23),quanti.sup= c(4:8,10,13,14,16), ncp=2, graph = FALSE)
?HCPC
res.hcpc<-HCPC(res.pca,order=TRUE)
res.hcpc<-HCPC(res.pca,order=TRUE)
res.hcpc<-HCPC(res.pca,order=TRUE)
library("FactoMineR", lib.loc="~/R/win-library/3.4")
res.hcpc<-HCPC(res.pca,order=TRUE)
res.hcpc<-HCPC(res.pca,order=TRUE)
res.hcpc<-HCPC(res.pca,order=TRUE)
save.image("C:/Users/Gorka/Desktop/Uni/ADEI/ADEI-CaseStudy/workspace.RData")
(X <- matrix(c(1, 1, 1, 1, 1, -1, 1, 2, 3, 5, 1, 1, 4, 9, 25),nrow=5))
T <- c(2, 1, 1, 0, 3)
(C <- t(X) %*% X)  # X^T X
(X.pseudo <- solve(C) %*% t(X))  # (X^T X)^{-1} X^T
w <- X.pseudo %*% T
test <- X %*% w
?plot
points <- matrix(c(-1, 2, 1, 1, 2, 1, 3, 0, 5, 3),nrow=2)
plot(points)
rm(points)
xs <- c(-1, 1, 2, 3, 5)
ys <- c(2, 1, 1, 0, 3)
points(xs, ys)
plot(-6:6, -6:6, type = "n")
points(xs, ys)
w[0]
w[1]
w[2]
curve(w[1]+x*w[2]+x^2*w[3], from=-6, to=6, , xlab="x", ylab="y")
points(xs, ys)
plot(-6:6, -6:6, type = "n")
curve(w[1]+x*w[2]+x^2*w[3], from=-6, to=6, , xlab="x", ylab="y")
?curve
curve(w[1]+x*w[2]+x^2*w[3], from=-6, to=6, , xlab="x", ylab="y")
points(xs, ys)
colnames(df4)
res.pca<-PCA(df4,
quali.sup=c(),quanti.sup= c(9:15))
library("FactoMineR", lib.loc="~/R/win-library/3.4")
res.pca<-PCA(df4,
quali.sup=c(),quanti.sup= c(9:15))
res.pca<-PCA(df4,quanti.sup= c(9:15))
res.pca<-PCA(df4, quali.sup=c(21), quanti.sup= c(9:15))
res.pca<-PCA(df4, quali.sup=c(), quanti.sup= c(9:15))
res.pca<-PCA(df4, quali.sup=c(), quanti.sup= c(9:15))
View(df4)
View(df4)
summary(df4$Extra)
is.numeric(df4$Extra)
is.numeric(df4$MTA_tax)
is.numeric(df4$Tip_amount)
is.numeric(df4$Tolls_amount)
is.numeric(df4$improvement_surcharge)
is.numeric(df4$Fare_amount)
is.numeric(df4$Trip_distance)
colnames(df4)
res.pca<-PCA(df4, quali.sup=c(1), quanti.sup= c(9:15))
res.pca<-PCA(df4, quali.sup=c(9:15), quanti.sup= c(9:15))
?impute.pca
?imputePCA
?estim_ncp
install.packages("missMDA")
library("FactoMineR", lib.loc="~/R/win-library/3.4")
library("missMDA", lib.loc="~/R/win-library/3.4")
?imputePCA
res.comp = imputePCA(res.pca[, c(9:15)], ncp=2)
res.comp = imputePCA(df4[, c(9:15)], ncp=2)
colnames(res.comp)
df5<-df4
df5$Trip_distance<-res.comp$completeObs[,1]
df5$Fare_amount<-res.comp$completeObs[,2]
df5$Extra<-res.comp$completeObs[,3]
df5$MTA_tax<-res.comp$completeObs[,4]
df5$Tip_amount<-res.comp$completeObs[,5]
df5$Tolls_amount<-res.comp$completeObs[,6]
df5$improvement_surcharge<-res.comp$completeObs[,7]
res.pca<-PCA(df5, quali.sup=c(), quanti.sup= c(9:15))
setwd("C:/Users/Gorka/Desktop/Uni/ADEI/ADEI-CaseStudy")
load("C:/Users/Gorka/Desktop/Uni/ADEI/ADEI-CaseStudy/.Rdata.RData")
View(dfDropoffs)
which(dfProva$Trip_distance == 13.70)
which(dfProva$Trip_distance == 13.60)
which(dfProva$Trip_distance == 13.80)
dfProva[which(dfProva$Trip_distance == 13.60),]
dfProva[220,]$Dropoff_latitude <- dfProva[1552,]$Dropoff_latitude
dfProva[220,]$Dropoff_longitude <- dfProva[1552,]$Dropoff_longitude
dfProva[which(dfProva$Trip_distance == 5.90),]
which(dfProva$Trip_distance == 5.90)
dfProva[1369 ,]$Dropoff_latitude <- dfProva[1391,]$Dropoff_latitude
dfProva[1369 ,]$Dropoff_longitude <- dfProva[1391,]$Dropoff_longitude
which(dfProva$Trip_distance == 2.63)
dfProva[which(dfProva$Trip_distance == 2.63),]
dfProva[1900 ,]$Dropoff_latitude <- dfProva[3249,]$Dropoff_latitude
dfProva[1900 ,]$Dropoff_longitude <- dfProva[3249,]$Dropoff_longitude
dfProva[which(dfProva$Trip_distance == 1.76),]
which(dfProva$Trip_distance == 1.76)
dfProva[2178 ,]$Dropoff_latitude <- dfProva[1950,]$Dropoff_latitude
dfProva[2178 ,]$Dropoff_longitude <- dfProva[1950,]$Dropoff_longitude
dfProva[which(dfProva$Trip_distance == 11.76),]
dfProva[which(dfProva$Trip_distance == 11.7),]
which(dfProva$Trip_distance == 11.76)
which(dfProva$Trip_distance == 11.7)
dfProva[4458 ,]$Dropoff_latitude <- dfProva[4097,]$Dropoff_latitude
dfProva[4458 ,]$Dropoff_longitude <- dfProva[4097,]$Dropoff_longitude
which(dfProva$Trip_distance == 2.5)
dfProva[which(dfProva$Trip_distance == 2.5),]
dfProva[4478 ,]$Dropoff_latitude <- dfProva[3786,]$Dropoff_latitude
dfProva[4478 ,]$Dropoff_longitude <- dfProva[3786,]$Dropoff_longitude
dfDropoffs <- dfProva[which(is.na(dfProva$Dropoff_longitude)),]
dfProva[which(dfProva$Fare_amount == 12.5),]
which(dfProva$Fare_amount == 12.5)
dfProva[74 ,]$Dropoff_latitude <- dfProva[334,]$Dropoff_latitude
dfProva[74 ,]$Dropoff_longitude <- dfProva[334,]$Dropoff_longitude
dfProva[which(dfProva$Fare_amount == 5),]
dfProva[which(dfProva$Fare_amount == 5.0),]
dfProva[which(dfProva$Fare_amount == 5.0 & is.na(dfProva$Dropoff_latitude)),]
which(dfProva$Fare_amount == 5.0 & is.na(dfProva$Dropoff_latitude)),
which(dfProva$Fare_amount == 5.0 & is.na(dfProva$Dropoff_latitude))
which(dfProva$Fare_amount == 5.0)
dfProva[ 401 ,]$Dropoff_latitude <- dfProva[30 ,]$Dropoff_latitude
dfProva[ 401 ,]$Dropoff_longitude <- dfProva[30 ,]$Dropoff_longitude
which(dfProva$Fare_amount == 1.0)
which(dfProva$Fare_amount == 1.1)
which(dfProva$Fare_amount == 1.2)
which(dfProva$Fare_amount == 1.3)
which(dfProva$Fare_amount == 1.5)
which(dfProva$Fare_amount == 0.5)
View(dfProva)
which(dfProva$Fare_amount == 0.7)
dfProva[ 609 ,]$Dropoff_latitude <- dfProva[ 2075 ,]$Dropoff_latitude
dfProva[ 609 ,]$Dropoff_longitude <- dfProva[ 2075 ,]$Dropoff_longitude
dfProva[ 2998 ,]$Dropoff_latitude <- dfProva[ 2075 ,]$Dropoff_latitude
dfProva[ 2998 ,]$Dropoff_longitude <- dfProva[ 2075 ,]$Dropoff_longitude
dfDropoffs <- dfProva[which(is.na(dfProva$Dropoff_longitude)),]
dfProva[which(dfProva$Fare_amount == 18.5),]
df18.5 <- dfProva[which(dfProva$Fare_amount == 18.5),]
View(df18.5)
which(dfProva$Fare_amount == 18.5 & is.na(df$Dropoff_longitude)
)
which(dfProva$Fare_amount == 18.5 & dfProva$Trip_distance == 4.73)
dfProva[ 3891 ,]$Dropoff_latitude <- dfProva[ 784 ,]$Dropoff_latitude
dfProva[ 3891 ,]$Dropoff_longitude <- dfProva[ 784 ,]$Dropoff_longitude
dfProva[which(dfProva$Fare_amount == 21.5),]
df18.5 <- dfProva[which(dfProva$Fare_amount == 21.5),]
which(dfProva$Fare_amount == 21.5 & is.na(df$Dropoff_latitude))
which(dfProva$Fare_amount == 21.5 & dfProva$Trip_distance == 5.6)
which(dfProva$Fare_amount == 21.5 & dfProva$Dropoff_latitude == -73.83807)
which(dfProva$Fare_amount == 21.5 & dfProva$Dropoff_longitude == -73.83807)
dfProva[which(dfProva$Fare_amount == 21.5 & dfProva$Trip_distance == 5.6),]
dfProva[ 4061 ,]$Dropoff_latitude <- dfProva[ 2780 ,]$Dropoff_latitude
dfProva[ 4061 ,]$Dropoff_longitude <- dfProva[ 2780 ,]$Dropoff_longitude
dfDropoffs <- dfProva[which(is.na(dfProva$Dropoff_longitude)),]
rm(dfDropoffs)
degrees.to.radians<-function(value) {
return(value*0.0174532925)
}
man.dist.manual <- function(p1Lat, p1Lon, p2Lat, p2Lon) {
#return(abs(pointDistance(c(p1$lon, p1$lat), c(p1$lon, p2$lat), longlat=TRUE)) + abs(pointDistance(c(p2$lon, p1$lat), c(p2$lon, p2$lat), longlat=TRUE)))
R = 6371
lat1 = degrees.to.radians(p1Lat)
lon1 = degrees.to.radians(p1Lon)
lat2 = degrees.to.radians(p2Lat)
lon2 = degrees.to.radians(p2Lon)
A_lat = lat2 - lat1
A_lon = lon2 - lon1
a = sin(A_lat/2)^2
c = 2 * atan2(sqrt(a), sqrt(1-a))
dist_lat = R * c
a = sin(A_lon/2)^2
c = 2 * atan2(sqrt(a), sqrt(1-a))
dist_lon = R * c
abs(dist_lat) + abs(dist_lon)
return(abs(dist_lat) + abs(dist_lon))
}
vectorDistances <- man.dist.manual(dfProva$Pickup_latitude, dfProva$Pickup_longitude, dfProva$Dropoff_latitude, dfProva$Dropoff_longitude)
dfD4$tlenkm <- vectorDistances
View(dfProva)
dfProva$tlenkm <- vectorDistances
df[which(is.na(dfProva$f.extra)),]
df[which(is.na(dfProva$f.extra)),]  <- 0.5
View(df)
dfProva[which(is.na(dfProva$f.extra)),]
dfProva[which(is.na(dfProva$f.extra)),]  <- 0.5
rm(df18.5)
dfD4  <- dfProva
dfProva[which(is.na(dfProva$Extra)),]
dfProva[which(is.na(dfProva$Extra))]
dfProva$Extra
dfProva[which(is.na(dfProva$Extra)),]
which(is.na(dfProva$Extra))
dfProva[which(is.na(dfProva$f.MTA)),]  <- 0.5
View(dfProva)
dfProva[which(is.na(dfProva$f.passcount)),]  <- 1
warnings()
View(dfD4)
?history
savehistory()
